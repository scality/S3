---
general:
  branches:
    ignore:
      - /^ultron\/.*/   # Ignore ultron/* branches
  artifacts:
    - coverage/

machine:
  node:
    version: 4.5.0
  ruby:
    version: "2.0"
  environment:
    CXX: g++-4.9

dependencies:
  post:
    - sudo pip install flake8 yamllint
    # java sdk dependencies
    - sudo apt-get install -y -q default-jdk


test:
  override:
    - S3BACKEND=mem npm start & sleep 4 && npm run ft_test;
    - S3BACKEND=mem npm start & sleep 4 &&
      ENABLE_KMS_ENCRYPTION=true npm run ft_test;
    - S3BACKEND=file S3VAULT=mem npm start & sleep 15 && npm run ft_test;
    - S3BACKEND=file S3VAULT=mem npm start & sleep 15 &&
      ENABLE_KMS_ENCRYPTION=true npm run ft_test;
